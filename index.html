<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <!-- 1. 核心：启用 iOS Web App 模式（全屏，隐藏浏览器UI） -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <!-- 2. 配置状态栏样式（适配全屏，可选值：default/black/black-translucent） -->
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- 3. 设置添加到主屏幕后的应用名称 -->
    <meta name="apple-mobile-web-app-title" content="运动详情">
    <!-- 4. 优化视口（保留原有配置，补充全屏适配） -->
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>运动详情</title>
    <!-- 引入 Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 引入 Font Awesome 4.7.0 CDN -->
    <!-- Font Awesome 7.1.0 Free 核心 CDN（替换原有 6.4.0/4.7.0） -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css">
    <!-- 配置 Tailwind 自定义颜色（匹配原有配色） -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'time-primary': '#0088ff',
                        'time-bg': 'rgba(0, 136, 255, 0.1)',
                        'calorie-primary': '#ff6666',
                        'calorie-bg': 'rgba(255, 102, 102, 0.1)',
                        'pace-primary': '#33cc99',
                        'pace-bg': 'rgba(51, 204, 153, 0.1)',
                        'steprate-primary': '#ffcc00',
                        'steprate-bg': 'rgba(255, 204, 0, 0.1)',
                    }
                }
            }
        }
    </script>
    <!-- 少量自定义工具类（补充 Tailwind 原生未覆盖的细节） -->
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .text-pace { /* 配速特殊格式的行高 */
                line-height: 1;
            }
        }
        /* 适配刘海屏/灵动岛的安全区域（可选，优化全屏体验） */
        body {
            padding-top: constant(safe-area-inset-top);
            padding-top: env(safe-area-inset-top);
            padding-bottom: constant(safe-area-inset-bottom);
            padding-bottom: env(safe-area-inset-bottom);
        }
    </style>
</head>

<body class="bg-[#f5f5f7] p-4">
    <!-- 顶部标签栏 -->
    <div class="flex gap-6 mb-5 mt-10">
        <div class="text-sm text-gray-500">轨迹</div>
        <div class="text-sm text-gray-500">配速</div>
        <div class="text-sm text-gray-500">分段</div>
        <div class="text-sm text-gray-500">图表</div>
        <div class="text-sm text-black font-semibold">详情</div>
    </div>

    <!-- 日期 -->
    <div class="text-sm text-gray-600 mb-3" id="date">2025年3月31日 早上7:11</div>

    <!-- 公里数 -->
    <div class="mb-2">
        <span class="text-[60px] font-bold text-black text-pace" id="distance">6.72</span>
        <span class="text-2xl text-black ml-1">公里</span>
    </div>

    <!-- 描述文本 -->
    <div class="text-sm text-gray-600 mb-6 leading-relaxed">本次锻炼提升有氧体能，增强心肺能力，强度较高。</div>

    <!-- 数据网格 - 使用 Tailwind 网格布局 -->
    <div class="grid grid-cols-2 gap-4">
        <!-- 运动时间 -->
        <div class="bg-white rounded-xl p-4 flex flex-col gap-2">
            <div
                class="w-8 h-8 flex items-center justify-center text-lg rounded-full text-time-primary bg-time-bg mb-2">
                <i class="fa-regular fa-clock"></i>
            </div>
            <div class="text-xl font-semibold text-black" id="duration">00:42:40</div>
            <div class="text-xs text-gray-400">运动时间</div>
        </div>

        <!-- 总消耗热量 -->
        <div class="bg-white rounded-xl p-4 flex flex-col gap-2">
            <div
                class="w-8 h-8 flex items-center justify-center text-lg rounded-full text-calorie-primary bg-calorie-bg mb-2">
                <i class="fa fa-fire"></i>
            </div>
            <div class="text-xl font-semibold text-black" id="calorie">474</div>
            <div class="text-xs text-gray-400">总消耗热量 (千卡)</div>
        </div>

        <!-- 平均配速 -->
        <div class="bg-white rounded-xl p-4 flex flex-col gap-2">
            <div
                class="w-8 h-8 flex items-center justify-center text-lg rounded-full text-pace-primary bg-pace-bg mb-2">
                <i class="fa-solid fa-gauge-high"></i>
            </div>
            <div class="text-xl font-semibold text-black" id="pace">6'21''</div>
            <div class="text-xs text-gray-400">平均配速 (分钟/公里)</div>
        </div>

        <!-- 平均速度 -->
        <div class="bg-white rounded-xl p-4 flex flex-col gap-2">
            <div
                class="w-8 h-8 flex items-center justify-center text-lg rounded-full text-pace-primary bg-pace-bg mb-2">
                <i class="fa fa-bolt"></i>
            </div>
            <div class="text-xl font-semibold text-black" id="speed">9.45</div>
            <div class="text-xs text-gray-400">平均速度 (公里/小时)</div>
        </div>

        <!-- 平均步频 -->
        <div class="bg-white rounded-xl p-4 flex flex-col gap-2">
            <div
                class="w-8 h-8 flex items-center justify-center text-lg rounded-full text-steprate-primary bg-steprate-bg mb-2">
                <i class="fa fa-refresh"></i>
            </div>
            <div class="text-xl font-semibold text-black" id="stepRate">182</div>
            <div class="text-xs text-gray-400">平均步频 (步/分钟)</div>
        </div>

        <!-- 平均步幅 -->
        <div class="bg-white rounded-xl p-4 flex flex-col gap-2">
            <div
                class="w-8 h-8 flex items-center justify-center text-lg rounded-full text-pace-primary bg-pace-bg mb-2">
                <i class="fa fa-arrows-h"></i>
            </div>
            <div class="text-xl font-semibold text-black" id="stepLength">86</div>
            <div class="text-xs text-gray-400">平均步幅 (厘米)</div>
        </div>

        <!-- 步数 -->
        <div class="bg-white rounded-xl p-4 flex flex-col gap-2">
            <div
                class="w-8 h-8 flex items-center justify-center text-lg rounded-full text-time-primary bg-time-bg mb-2">
                <i class="fa-solid fa-shoe-prints"></i>
            </div>
            <div class="text-xl font-semibold text-black" id="steps">7,775</div>
            <div class="text-xs text-gray-400">步数</div>
        </div>

        <!-- 平均心率 -->
        <div class="bg-white rounded-xl p-4 flex flex-col gap-2">
            <div
                class="w-8 h-8 flex items-center justify-center text-lg rounded-full text-calorie-primary bg-calorie-bg mb-2">
                <i class="fa fa-heartbeat"></i>
            </div>
            <div class="text-xl font-semibold text-black" id="heartRate">137</div>
            <div class="text-xs text-gray-400">平均心率 (次/分钟)</div>
        </div>
    </div>

    <script>
        // 核心逻辑：随机生成数据并反算关联指标（修改日期为当前时间）
        function generateSportsData() {
            // 1. 随机生成步数（5000-20000）
            const steps = Math.floor(Math.random() * (20000 - 5000 + 1)) + 5000;

            // 2. 随机生成基础参数（合理范围）
            const stepLength = Math.floor(Math.random() * (90 - 50 + 1)) + 50; // 步幅：50-90厘米
            const stepRate = Math.floor(Math.random() * (180 - 110 + 1)) + 110; // 步频：110-180步/分钟
            const heartRate = Math.floor(Math.random() * (150 - 100 + 1)) + 100; // 心率：100-150次/分钟

            // 3. 反算核心数据
            const distance = (steps * stepLength / 100 / 1000).toFixed(2); // 公里数：步数*步幅(厘米)/100(转米)/1000(转公里)
            const totalMinutes = steps / stepRate; // 总时长（分钟）
            const calorie = Math.floor(steps * 0.05); // 热量：每步约0.05千卡（可调整系数）

            // 4. 格式化运动时长（转成 HH:MM:SS）
            const hours = Math.floor(totalMinutes / 60);
            const minutes = Math.floor(totalMinutes % 60);
            const seconds = Math.floor((totalMinutes - Math.floor(totalMinutes)) * 60);
            const duration = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

            // 5. 计算配速（分钟/公里）并格式化（如6'21''）
            const paceMinutes = totalMinutes / parseFloat(distance); // 总分钟数 / 公里数 = 每公里分钟数
            const paceMin = Math.floor(paceMinutes); // 配速分钟部分
            const paceSec = Math.floor((paceMinutes - paceMin) * 60); // 配速秒数部分
            const pace = `${paceMin}'${paceSec.toString().padStart(2, '0')}''`;

            // 6. 计算平均速度（公里/小时）：3600秒 / (配速(分钟)*60秒) = 公里/小时
            const speed = (3600 / (paceMinutes * 60)).toFixed(2);

            // 7. 格式化步数（添加千分位）
            const formattedSteps = steps.toLocaleString();

            // 8. 生成当前时间（替换原随机日期逻辑）
            const now = new Date();
            const year = now.getFullYear(); // 当前年
            const month = now.getMonth() + 1; // 当前月（getMonth返回0-11，需+1）
            const day = now.getDate(); // 当前日
            let hour = now.getHours(); // 当前小时（24小时制）
            const minute = now.getMinutes(); // 当前分钟
            // 处理时段（早上/下午）和12小时制转换
            const period = hour < 12 ? '早上' : '下午';
            // 24小时制转12小时制（12点保持12，0点转12）
            hour = hour % 12 || 12;
            // 格式化日期字符串（保持原有格式）
            const date = `${year}年${month}月${day}日 ${period}${hour}:${minute.toString().padStart(2, '0')}`;

            // 9. 渲染到页面
            document.getElementById('date').textContent = date;
            document.getElementById('distance').textContent = distance;
            document.getElementById('duration').textContent = duration;
            document.getElementById('calorie').textContent = calorie;
            document.getElementById('pace').textContent = pace;
            document.getElementById('speed').textContent = speed;
            document.getElementById('stepRate').textContent = stepRate;
            document.getElementById('stepLength').textContent = stepLength;
            document.getElementById('steps').textContent = formattedSteps;
            document.getElementById('heartRate').textContent = heartRate;
        }

        // 页面加载时生成数据
        window.onload = generateSportsData;

        // 可选：监听全屏状态（如需主动控制）
        function checkFullscreen() {
            if (window.navigator.standalone) {
                console.log('已进入iOS Web App全屏模式');
            } else {
                console.log('在Safari浏览器中（非全屏）');
            }
        }
        window.addEventListener('load', checkFullscreen);
    </script>
</body>

</html>
